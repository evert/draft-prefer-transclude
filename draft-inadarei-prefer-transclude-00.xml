<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.7 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
]>

<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc compact="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>

<rfc ipr="trust200902" docName="inadarei-prefer-transclude" category="info">

  <front>
    <title abbrev="Transclude for HTTP Prefer">Transclude Preference for the HTTP Prefer Header</title>

    <author initials="I." surname="Nadareishvili" fullname="Irakli Nadareishvili">
      <organization></organization>
      <address>
        <postal>
          <street>114 5th Avenue</street>
          <city>New York</city>
          <country>United States</country>
        </postal>
        <email>irakli@gmail.com</email>
        <uri>http://www.freshblurbs.com/</uri>
      </address>
    </author>
    <author initials="E." surname="Wilde" fullname="Erik Wilde">
      <organization></organization>
      <address>
        <email>erik.wilde@dret.net</email>
        <uri>http://dret.net/netdret/</uri>
      </address>
    </author>

    <date year="2018"/>

    <area>General</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>The Transclude preference is a registered behavior for the HTTP Prefer header 
field. Its purpose is for clients to specify preferences that certain links in 
a response should be resolved by the server, instead of being served as links 
that the client can resolve.</t>



    </abstract>


    <note title="Note to Readers">


<t><spanx style="strong">RFC EDITOR: please remove this section before publication</spanx></t>

<t>The issues list for this draft can be found at <eref target="https://github.com/inadarei/draft-prefer-transclude/issues">https://github.com/inadarei/draft-prefer-transclude/issues</eref>.</t>

<t>The most recent draft is at <eref target="https://inadarei.github.io/draft-prefer-transclude/">https://inadarei.github.io/draft-prefer-transclude/</eref>.</t>


    </note>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>“Prefer Header for HTTP” <xref target="RFC7240"/> proposes an HTTP header that can be used 
to indicate that particular server behaviors are preferred by the client but 
are not required for successful completion of the request. It further defines 
several standard Preferences, such as the “return” preference. The “return” 
preference lets the server know that the client would prefer a specific 
representation of a resource in a response payload, e.g. full representation 
vs. a minimal one.</t>

<t>Preferences like the “return” one are critical for mobile scenarios as mobile 
applications are very sensitive to network latency, throughput and anything 
that can improve end-user experience, even on resource-constrained networks. 
Prefer header allows servers to tune and optimize its response payload based 
on client preferences, for instance: to only send mobile app a minimal response 
when it doesn’t need full resource.</t>

<t>The size of the payload is not the only preference that can improve 
user-experience in mobile scenarios, however. Closely related to the size of 
the payload, is the number of HTTP requests a client needs to make to get all 
of the required data. This is the challenge that “transclude” preference 
addresses.</t>

<t>When server sends hypermedia responses (e.g. in the case of Hypermedia APIs) 
some of the response data may be referenced via a URI link instead of being 
embedded in the payload itself. The need to grab data from a link can degrade 
experience of mobile applications, since they are forced to make multiple 
requests to per single end-user request. This is sometimes referred to as 
“chatty interface” and is a significant problem for mobile and Internet of 
Things scenarios.</t>

<t>Transclude preference notifies the server that the client would prefer the
server to proactively transclude certain content represented by links of
indicated link relation types. The notion of “link relation type”, in this
context is as defined by <xref target="RFC5988"/></t>

<t>As a result of using a transclude preference, a client receives all of the
required data already embedded in the response output, without the need to make
additional network calls.</t>

</section>
<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be
interpreted as described in <xref target="RFC2119"/>.</t>

</section>
<section anchor="transclude-usage-example" title="Transclude Usage Example">

<t>Following is an example of a client asking server to transclude data represented 
at the copyright, edit-form and “other-form” links. Since “other-form” is not 
a standard, IANA link relation type, client is using a URI for identifying the 
link relation type.</t>

<figure><artwork><![CDATA[
Get /blog/1223 HTTP/1.1
Host: api.example.org
Content-Type: application/json  
Prefer: transclude="copyright;edit-form;http://rels.io/other-form"
Vary: Prefer,Accept,Accept-Encoding
]]></artwork></figure>

<t>As you can see from the example, the transclude preference expects the value 
to be enclosed in double quotes, if there are multiple link relation types 
provided. Further, standard link relations SHOULD be indicated by name while 
custom link relation types SHOULD be indicated with a unique URI representing 
that link relation. Multiple link relation types MUST be separated by 
semicolons.</t>

<t>Example response may look something like the following:</t>

<figure><artwork><![CDATA[
HTTP/1.1 200 OK
Server: nginx/1.10.3 (Ubuntu)
Date: Sat, 27 Jun 2017 10:07:32 GMT
Content-Type: application/json; charset=utf-8
Transfer-Encoding: chunked
Connection: close
Vary: Prefer,Accept,Accept-Encoding
Preference-Applied: transclude="copyright;edit-form"
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: Content-Type
]]></artwork></figure>

<t>As you can see from this output, the server only transcluded copyright and 
edit-form link relation types, but not the custom type client requested. This 
is because preferences are just suggestions and server has no obligation related 
to them. In this case, we can assume that the server skipped the last link 
relation type because maybe it wasn’t familiar with it, or for some other 
reason.</t>

</section>
<section anchor="implementation-considerations" title="Implementation Considerations">

<t>Transclude preference is media-type agnostic. It should work with any response 
content-type. The mechanics of transclusion, however will either depend on 
capabilities of the response media-type or require a multi-part response with 
multiple media types in the response.</t>

</section>
<section anchor="multipart-response-example" title="Multipart Response Example">

<figure><artwork><![CDATA[
HTTP/1.1 200 OK
Server: nginx/1.4.6 (Ubuntu)
Date: Thu, 15 Sep 2017 11:03:32 GMT
Content-type: multipart/mixed; boundary="some boundary string"

--some boundary string
Content-Type: application/hal+json; charset=utf-8

{
    "_links": {
        "self": { "href": "/orders" },
        "edit-form": { "href": "/create" }
    },
    "currentlyProcessing": 14,
    "shippedToday": 20
}

--some boundary string
Content-Type: application/prs.hal-forms+json

{
    "_links" : {
        "self" : { "href" : "/create" }
    },
    "_templates" : {
        "default" : {
            "title" : "Create",
            "method" : "post",
            "contentType" : "application/json",
            "properties" : [
                {"name": "title", "required": true, 
                 "prompt": "Title"},
                {"name": "completed", "value": "false", 
                 "prompt": "Completed"}
            ]
        }
    }
}
--some boundary string--
]]></artwork></figure>

</section>
<section anchor="security-considerations" title="Security Considerations">

<t>None.</t>

</section>
<section anchor="iana-considerations" title="IANA Considerations">

<t>The HTTP Preference below is being registered with IANA per Section 5.1 of 
<xref target="RFC7240"/>:</t>

<t>Preference: transclude
Value:
Optional Parameters:
Description:
Reference: RFC XXXX</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="RFC5988" target='https://www.rfc-editor.org/info/rfc5988'>
<front>
<title>Web Linking</title>
<author initials='M.' surname='Nottingham' fullname='M. Nottingham'><organization /></author>
<date year='2010' month='October' />
<abstract><t>This document specifies relation types for Web links, and defines a registry for them.  It also defines the use of such links in HTTP headers with the Link header field.  [STANDARDS-TRACK]</t></abstract>
</front>
<seriesInfo name='RFC' value='5988'/>
<seriesInfo name='DOI' value='10.17487/RFC5988'/>
</reference>



<reference  anchor="RFC2119" target='https://www.rfc-editor.org/info/rfc2119'>
<front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
<date year='1997' month='March' />
<abstract><t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='2119'/>
<seriesInfo name='DOI' value='10.17487/RFC2119'/>
</reference>



<reference  anchor="RFC7240" target='https://www.rfc-editor.org/info/rfc7240'>
<front>
<title>Prefer Header for HTTP</title>
<author initials='J.' surname='Snell' fullname='J. Snell'><organization /></author>
<date year='2014' month='June' />
<abstract><t>This specification defines an HTTP header field that can be used by a client to request that certain behaviors be employed by a server while processing a request.</t></abstract>
</front>
<seriesInfo name='RFC' value='7240'/>
<seriesInfo name='DOI' value='10.17487/RFC7240'/>
</reference>




    </references>



<section anchor="acknowledgments" title="Acknowledgments">

</section>


  </back>

<!-- ##markdown-source:
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

-->

</rfc>

