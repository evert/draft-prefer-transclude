<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.7 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
]>

<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc compact="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>

<rfc ipr="trust200902" docName="inadarei-prefer-transclude" category="info">

  <front>
    <title abbrev="Transclude for HTTP Prefer">Transclude Preference for the HTTP Prefer Header</title>

    <author initials="I." surname="Nadareishvili" fullname="Irakli Nadareishvili">
      <organization></organization>
      <address>
        <postal>
          <street>114 5th Avenue</street>
          <city>New York</city>
          <country>United States</country>
        </postal>
        <email>irakli@gmail.com</email>
        <uri>http://www.freshblurbs.com/</uri>
      </address>
    </author>
    <author initials="E." surname="Wilde" fullname="Erik Wilde">
      <organization></organization>
      <address>
        <email>dret@ca.com</email>
        <uri>http://dret.net/netdret/</uri>
      </address>
    </author>

    <date year="2018"/>

    <area>General</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>The Transclude preference is a registered behavior for the HTTP Prefer header 
field. Its purpose is for clients to specify preferences that certain links in 
a response should be resolved by the server, instead of being served as links 
that the client can resolve.</t>



    </abstract>


    <note title="Note to Readers">


<t><spanx style="strong">RFC EDITOR: please remove this section before publication</spanx></t>

<t>The issues list for this draft can be found at <eref target="https://github.com/inadarei/draft-prefer-transclude/issues">https://github.com/inadarei/draft-prefer-transclude/issues</eref>.</t>

<t>The most recent draft is at <eref target="https://inadarei.github.io/draft-prefer-transclude/">https://inadarei.github.io/draft-prefer-transclude/</eref>.</t>


    </note>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>“Prefer Header for HTTP” <xref target="RFC7240"/> proposes an HTTP header that can be used 
to indicate that particular server behaviors are preferred by the client but 
are not required for successful completion of the request. It further defines 
several standard Preferences, such as the “return” preference. The “return” 
preference lets the server know that the client would prefer a specific 
representation of a resource in a response payload, e.g. full representation 
vs. a minimal one.</t>

<t>Preferences like the “return” one are critical for mobile scenarios as mobile 
applications are very sensitive to network latency, throughput and anything 
that can improve end-user experience, even on resource-constrained networks. 
Prefer header allows servers to tune and optimize its response payload based 
on client preferences, for instance: to only send mobile app a minimal response 
when it doesn’t need full resource.</t>

<t>The size of the payload is not the only preference that can improve 
user-experience in mobile scenarios, however. Closely related to the size of 
the payload, is the number of HTTP requests a client needs to make to get all 
of the required data. This is the challenge that “transclude” preference 
addresses.</t>

<t>When server sends hypermedia responses (e.g. in the case of Hypermedia APIs) 
some of the response data may be referenced via a URI link instead of being 
embedded in the payload itself. The need to grab data from a link can degrade 
experience of mobile applications, since they are forced to make multiple 
requests to per single end-user request. This is sometimes referred to as 
“chatty interface” and is a significant problem for mobile and Internet of 
Things scenarios.</t>

<t>Transclude preference notifies the server that the client would prefer the
server to proactively transclude certain content represented by links of
indicated link relation types. The notion of “link relation type”, in this
context is as defined by <xref target="RFC5988"/></t>

<t>As a result of using a transclude preference, a client receives all of the
required data already embedded in the response output, without the need to make
additional network calls.</t>

</section>
<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be
interpreted as described in <xref target="RFC2119"/>.</t>

</section>
<section anchor="transclude-usage-example" title="Transclude Usage Example">

<t>Following is an example of a client asking server to transclude data represented 
at the copyright, edit-form and “other-form” links. Since “other-form” is not 
a standard, IANA link relation type, client is using a URI for identifying the 
link relation type.</t>

<figure><artwork><![CDATA[
Get /blog/1223 HTTP/1.1
Host: api.example.org
Content-Type: application/json  
Prefer: transclude="copyright;edit-form;http://rels.io/other-form"
Vary: Prefer,Accept,Accept-Encoding
]]></artwork></figure>

<t>As you can see from the example, the transclude preference expects the value 
to be enclosed in double quotes, if there are multiple link relation types 
provided. Further, standard link relations SHOULD be indicated by name while 
custom link relation types SHOULD be indicated with a unique URI representing 
that link relation. Multiple link relation types MUST be separated by 
semicolons.</t>

<t>Example response may look something like the following:</t>

<figure><artwork><![CDATA[
HTTP/1.1 200 OK
Server: nginx/1.10.3 (Ubuntu)
Date: Sat, 27 Jun 2015 11:05:32 GMT
Content-Type: application/json; charset=utf-8
Transfer-Encoding: chunked
Connection: close
Vary: Prefer,Accept,Accept-Encoding
Preference-Applied: transclude="copyright;edit-form"
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: Content-Type
]]></artwork></figure>

<t>As you can see from this output, the server only transcluded copyright and 
edit-form link relation types, but not the custom type client requested. This 
is because preferences are just suggestions and server has no obligation related 
to them. In this case, we can assume that the server skipped the last link 
relation type because maybe it wasn’t familiar with it, or for some other 
reason.</t>

</section>
<section anchor="implementation-considerations" title="Implementation Considerations">

<t>Transclude preference is media-type agnostic. It should work with any response 
content-type. The mechanics of transclusion, however will either depend on 
capabilities of the response media-type or require a multi-part response with 
multiple media types in the response.</t>

</section>
<section anchor="multipart-response-example" title="Multipart Response Example">

<figure><artwork><![CDATA[
HTTP/1.1 200 OK
Server: nginx/1.4.6 (Ubuntu)
Date: Thu, 15 Sep 2016 11:03:32 GMT
Content-type: multipart/mixed; boundary="some boundary string"

--some boundary string
Content-Type: application/hal+json; charset=utf-8

{
    "_links": {
        "self": { "href": "/orders" },
        "edit-form": { "href": "/create" }
    },
    "currentlyProcessing": 14,
    "shippedToday": 20
}

--some boundary string
Content-Type: application/prs.hal-forms+json

{
    "_links" : {
        "self" : { "href" : "/create" }
    },
    "_templates" : {
        "default" : {
            "title" : "Create",
            "method" : "post",
            "contentType" : "application/json",
            "properties" : [
                {"name": "title", "required": true, 
                 "prompt": "Title"},
                {"name": "completed", "value": "false", 
                 "prompt": "Completed"}
            ]
        }
    }
}
--some boundary string--
]]></artwork></figure>

</section>
<section anchor="security-considerations" title="Security Considerations">

<t>None.</t>

</section>
<section anchor="iana-considerations" title="IANA Considerations">

<t>The HTTP Preference below is being registered with IANA per Section 5.1 of 
<xref target="RFC7240"/>:</t>

<t>Preference: transclude
Value:
Optional Parameters:
Description:
Reference: RFC XXXX</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="RFC5988" target='https://www.rfc-editor.org/info/rfc5988'>
<front>
<title>Web Linking</title>
<author initials='M.' surname='Nottingham' fullname='M. Nottingham'><organization /></author>
<date year='2010' month='October' />
<abstract><t>This document specifies relation types for Web links, and defines a registry for them.  It also defines the use of such links in HTTP headers with the Link header field.  [STANDARDS-TRACK]</t></abstract>
</front>
<seriesInfo name='RFC' value='5988'/>
<seriesInfo name='DOI' value='10.17487/RFC5988'/>
</reference>



<reference  anchor="RFC2119" target='https://www.rfc-editor.org/info/rfc2119'>
<front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
<date year='1997' month='March' />
<abstract><t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='2119'/>
<seriesInfo name='DOI' value='10.17487/RFC2119'/>
</reference>



<reference  anchor="RFC7240" target='https://www.rfc-editor.org/info/rfc7240'>
<front>
<title>Prefer Header for HTTP</title>
<author initials='J.' surname='Snell' fullname='J. Snell'><organization /></author>
<date year='2014' month='June' />
<abstract><t>This specification defines an HTTP header field that can be used by a client to request that certain behaviors be employed by a server while processing a request.</t></abstract>
</front>
<seriesInfo name='RFC' value='7240'/>
<seriesInfo name='DOI' value='10.17487/RFC7240'/>
</reference>




    </references>



<section anchor="acknowledgments" title="Acknowledgments">

</section>


  </back>

<!-- ##markdown-source:
H4sIAJIxXVoAA51Z23IbNxJ9x1eg6IdNvCR1sZ049CYVla3EytqSV6I2m0ql
XOAMSCKaGUwAjGSuS/n2Pd3AXEgxTmpVZWtmcOvL6dPd0GQyEcGEQs/k3KnK
Z0WTa/nO6aV2usq0XFonw1rL1/P5u/RdvtYq106oxcLp262FNHswU+Q2q1SJ
zU2lcuW0mdQ8MAndGpGrgAnHh0fPRYbHlXUbmr+0QpjazWRwjQ/Hh4dfHR4L
bKFm8ntdaacKcWfdzcrZpp6JG73BWz6TZ1XQrtJh8sqpZRDCB1Xl71VhKxyy
0V7UZiZ/DjYbS/xnqlxXYSy9dQGCeTxtyvQQnMkwlNmyVumhxGQMmaowlf5F
CNWEtXUzISdC4sdUHgJM5XnU1a9vTWF4JBrhzKmbwuwZxllah5k8Onoqn4W1
PLnVVaN5KDMB5jjXd/InaBs/2aYKZKTrygSdy6sAs3ke0qUyBazHB327orcp
5OaxxkHzdQj17ODg7u5uunTarxdF4xae5hxsaXE6lT+aItcD6U+duRl8TEfl
TodvM7X3FBqbwhcH+EfPB0JU1pUqmFsNo8nL714+++r58/R4fHT0VXr88vjp
4QzuBwgG0x/FoSeH3csXz59gtZhMJlItYET4SYg50DqAZN1j2XippNMr44ER
GG6h1+rWALL7QL5mkEuxNLrIp/IseFk3rrae96EVWWEID8CR9LXOzHIzOAyf
1yrITLugTCUBmBsP00pBEvjaVtjHr21TkBj0yRa3JNKGBfHa3WpHSIOoKpd2
iVmmWsWBXCqfdhR8Ci2J0shMVe1u02iZygb9/pz+C/b9JWvlhXj8GPaTp6/O
5heXM1kXWnkSo7S3GttBQ6+zYGyFc6ErzNgsCoP4xKfHj6ORjfeNJkF8SBbE
spzCjqVYEB00FYQN8h+ECA9IrExYNwvGW0sJB7zkITEcxP2/mcbTSotjnM5I
yXgIuXOwdbvfNJ1h7B/u/E0yTWnyvNBCPCLacDZvWGUhRltE17HaSH78mNB5
fw9fW0IDhKgicBJiot+jARoPZwkABERD1tNxtFYumKwplEue7qCI3VyLWdfj
ITl30QRJHEg+hS1+awzNIfF8kwFzftkUTFiFZt8BNrSaZmofCMRy2Th8cjLX
S3AYAOT1LZGpZKJULh+QP7Fgk60JbbTNCCHcuGo0QPlUzocDYhBsEMEPsCxv
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

-->

</rfc>

