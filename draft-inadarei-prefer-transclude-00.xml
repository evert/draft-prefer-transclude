<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.7 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
]>

<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc compact="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>

<rfc ipr="trust200902" docName="inadarei-prefer-transclude" category="info">

  <front>
    <title abbrev="Transclude for HTTP Prefer">Transclude Preference for the HTTP Prefer Header</title>

    <author initials="I." surname="Nadareishvili" fullname="Irakli Nadareishvili">
      <organization></organization>
      <address>
        <postal>
          <street>114 5th Avenue</street>
          <city>New York</city>
          <country>United States</country>
        </postal>
        <email>irakli@gmail.com</email>
        <uri>http://www.freshblurbs.com/</uri>
      </address>
    </author>
    <author initials="E." surname="Wilde" fullname="Erik Wilde">
      <organization></organization>
      <address>
        <email>erik.wilde@dret.net</email>
        <uri>http://dret.net/netdret/</uri>
      </address>
    </author>

    <date year="2018"/>

    <area>General</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>The Transclude preference is a registered behavior for the HTTP Prefer header 
field. Its purpose is for clients to specify preferences that certain links in 
a response should be resolved by the server, instead of being served as links 
that the client can resolve.</t>



    </abstract>


    <note title="Note to Readers">


<t><spanx style="strong">RFC EDITOR: please remove this section before publication</spanx></t>

<t>The issues list for this draft can be found at <eref target="https://github.com/inadarei/draft-prefer-transclude/issues">https://github.com/inadarei/draft-prefer-transclude/issues</eref>.</t>

<t>The most recent draft is at <eref target="https://inadarei.github.io/draft-prefer-transclude/">https://inadarei.github.io/draft-prefer-transclude/</eref>.</t>


    </note>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>“Prefer Header for HTTP” <xref target="RFC7240"/> proposes an HTTP header that can be used 
to indicate that particular server behaviors are preferred by the client but 
are not required for successful completion of the request. It further defines 
several standard Preferences, such as the “return” preference. The “return” 
preference lets the server know that the client would prefer a specific 
representation of a resource in a response payload, e.g. full representation 
vs. a minimal one.</t>

<t>Preferences like the “return” one are critical for mobile scenarios as mobile 
applications are very sensitive to network latency, throughput and anything 
that can improve end-user experience, even on resource-constrained networks. 
Prefer header allows servers to tune and optimize its response payload based 
on client preferences, for instance: to only send mobile app a minimal response 
when it doesn’t need full resource.</t>

<t>The size of the payload is not the only preference that can improve 
user-experience in mobile scenarios, however. Closely related to the size of 
the payload, is the number of HTTP requests a client needs to make to get all 
of the required data. This is the challenge that “transclude” preference 
addresses.</t>

<t>When server sends hypermedia responses (e.g. in the case of Hypermedia APIs) 
some of the response data may be referenced via a URI link instead of being 
embedded in the payload itself. The need to grab data from a link can degrade 
experience of mobile applications, since they are forced to make multiple 
requests to per single end-user request. This is sometimes referred to as 
“chatty interface” and is a significant problem for mobile and Internet of 
Things scenarios.</t>

<t>Transclude preference notifies the server that the client would prefer the
server to proactively transclude certain content represented by links of
indicated link relation types. The notion of “link relation type”, in this
context is as defined by <xref target="RFC8288"/></t>

<t>As a result of using a transclude preference, a client receives all of the
required data already embedded in the response output, without the need to make
additional network calls.</t>

</section>
<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be
interpreted as described in <xref target="RFC2119"/>.</t>

</section>
<section anchor="transclude-usage-example" title="Transclude Usage Example">

<t>Following is an example of a client asking server to transclude data represented 
at the copyright, edit-form and “other-form” links. Since “other-form” is not 
a standard, IANA link relation type, client is using a URI for identifying the 
link relation type.</t>

<figure><artwork><![CDATA[
Get /blog/1223 HTTP/1.1
Host: api.example.org
Content-Type: application/json  
Prefer: transclude="copyright;edit-form;http://rels.io/other-form"
Vary: Prefer,Accept,Accept-Encoding
]]></artwork></figure>

<t>As you can see from the example, the transclude preference expects the value 
to be enclosed in double quotes, if there are multiple link relation types 
provided. Further, standard link relations SHOULD be indicated by name while 
custom link relation types SHOULD be indicated with a unique URI representing 
that link relation. Multiple link relation types MUST be separated by 
semicolons.</t>

<t>Example response may look something like the following:</t>

<figure><artwork><![CDATA[
HTTP/1.1 200 OK
Server: nginx/1.10.3 (Ubuntu)
Date: Sat, 27 Jun 2017 10:07:32 GMT
Content-Type: application/json; charset=utf-8
Transfer-Encoding: chunked
Connection: close
Vary: Prefer,Accept,Accept-Encoding
Preference-Applied: transclude="copyright;edit-form"
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: Content-Type
]]></artwork></figure>

<t>As you can see from this output, the server only transcluded copyright and 
edit-form link relation types, but not the custom type client requested. This 
is because preferences are just suggestions and server has no obligation related 
to them. In this case, we can assume that the server skipped the last link 
relation type because maybe it wasn’t familiar with it, or for some other 
reason.</t>

</section>
<section anchor="implementation-considerations" title="Implementation Considerations">

<t>Transclude preference is media-type agnostic. It should work with any response 
content-type. The mechanics of transclusion, however will either depend on 
capabilities of the response media-type or require a multi-part response with 
multiple media types in the response.</t>

</section>
<section anchor="multipart-response-example" title="Multipart Response Example">

<figure><artwork><![CDATA[
HTTP/1.1 200 OK
Server: nginx/1.4.6 (Ubuntu)
Date: Thu, 15 Sep 2017 11:07:32 GMT
Content-type: multipart/mixed; boundary="some boundary string"

--some boundary string
Content-Type: application/hal+json; charset=utf-8

{
    "_links": {
        "self": { "href": "/orders" },
        "edit-form": { "href": "/create" }
    },
    "currentlyProcessing": 14,
    "shippedToday": 20
}

--some boundary string
Content-Type: application/prs.hal-forms+json

{
    "_links" : {
        "self" : { "href" : "/create" }
    },
    "_templates" : {
        "default" : {
            "title" : "Create",
            "method" : "post",
            "contentType" : "application/json",
            "properties" : [
                {"name": "title", "required": true, 
                 "prompt": "Title"},
                {"name": "completed", "value": "false", 
                 "prompt": "Completed"}
            ]
        }
    }
}
--some boundary string--
]]></artwork></figure>

</section>
<section anchor="security-considerations" title="Security Considerations">

<t>Specific resources transcluded by a client can introduce security
considerations and concerns beyond those discussed within Prefer Header for 
HTTP <xref target="RFC7240]"/>, or HTTP/1.1 <xref target="RFC7230"/> and its associated specification 
documents (see <xref target="RFC7230"/> for the list of associated works). Implementers 
need to consider implications of including supported media types and implement
appropriate security measures.</t>

<t>A server could incur greater costs in attempting to comply with a
trasnclusion preference.  Unconditional compliance from a server could
allow the use of preferences for denial of service.  A server can
ignore an expressed preference to avoid expending resources that it
does not wish to commit.</t>

</section>
<section anchor="iana-considerations" title="IANA Considerations">

<t>The HTTP Preference below is being registered with IANA per Section 5.1 of 
<xref target="RFC7240"/>:</t>

<t>Preference: transclude
Value:
Optional Parameters:
Description:
Reference: RFC XXXX</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="RFC8288" target='https://www.rfc-editor.org/info/rfc8288'>
<front>
<title>Web Linking</title>
<author initials='M.' surname='Nottingham' fullname='M. Nottingham'><organization /></author>
<date year='2017' month='October' />
<abstract><t>This specification defines a model for the relationships between resources on the Web (&quot;links&quot;) and the type of those relationships (&quot;link relation types&quot;).</t><t>It also defines the serialisation of such links in HTTP headers with the Link header field.</t></abstract>
</front>
<seriesInfo name='RFC' value='8288'/>
<seriesInfo name='DOI' value='10.17487/RFC8288'/>
</reference>



<reference  anchor="RFC2119" target='https://www.rfc-editor.org/info/rfc2119'>
<front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
<date year='1997' month='March' />
<abstract><t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='2119'/>
<seriesInfo name='DOI' value='10.17487/RFC2119'/>
</reference>



<reference  anchor="RFC7240" target='https://www.rfc-editor.org/info/rfc7240'>
<front>
<title>Prefer Header for HTTP</title>
<author initials='J.' surname='Snell' fullname='J. Snell'><organization /></author>
<date year='2014' month='June' />
<abstract><t>This specification defines an HTTP header field that can be used by a client to request that certain behaviors be employed by a server while processing a request.</t></abstract>
</front>
<seriesInfo name='RFC' value='7240'/>
<seriesInfo name='DOI' value='10.17487/RFC7240'/>
</reference>




    </references>



<section anchor="acknowledgments" title="Acknowledgments">

</section>


  </back>

<!-- ##markdown-source:
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

-->

</rfc>

