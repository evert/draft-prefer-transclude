<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.7 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
]>

<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc compact="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>

<rfc ipr="trust200902" docName="inadarei-prefer-transclude" category="info">

  <front>
    <title abbrev="Transclude for HTTP Prefer">Transclude Preference for the HTTP Prefer Header</title>

    <author initials="I." surname="Nadareishvili" fullname="Irakli Nadareishvili">
      <organization></organization>
      <address>
        <postal>
          <street>114 5th Avenue</street>
          <city>New York</city>
          <country>United States</country>
        </postal>
        <email>irakli@gmail.com</email>
        <uri>http://www.freshblurbs.com/</uri>
      </address>
    </author>
    <author initials="E." surname="Wilde" fullname="Erik Wilde">
      <organization></organization>
      <address>
        <email>erik.wilde@dret.net</email>
        <uri>http://dret.net/netdret/</uri>
      </address>
    </author>

    <date year="2018"/>

    <area>General</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>The Transclude preference is a registered behavior for the HTTP Prefer header 
field. Its purpose is for clients to specify preferences that certain links in 
a response should be resolved by the server, instead of being served as links 
that the client can resolve.</t>



    </abstract>


    <note title="Note to Readers">


<t><spanx style="strong">RFC EDITOR: please remove this section before publication</spanx></t>

<t>The issues list for this draft can be found at <eref target="https://github.com/inadarei/draft-prefer-transclude/issues">https://github.com/inadarei/draft-prefer-transclude/issues</eref>.</t>

<t>The most recent draft is at <eref target="https://inadarei.github.io/draft-prefer-transclude/">https://inadarei.github.io/draft-prefer-transclude/</eref>.</t>


    </note>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>“Prefer Header for HTTP” <xref target="RFC7240"/> proposes an HTTP header that can be used 
to indicate that particular server behaviors are preferred by the client but 
are not required for successful completion of the request. It further defines 
several standard Preferences, such as the “return” preference. The “return” 
preference lets the server know that the client would prefer a specific 
representation of a resource in a response payload, e.g. full representation 
vs. a minimal one.</t>

<t>Preferences like the “return” one are critical for mobile scenarios as mobile 
applications are very sensitive to network latency, throughput and anything 
that can improve end-user experience, even on resource-constrained networks. 
Prefer header allows servers to tune and optimize its response payload based 
on client preferences, for instance: to only send mobile app a minimal response 
when it doesn’t need full resource.</t>

<t>The size of the payload is not the only preference that can improve 
user-experience in mobile scenarios, however. Closely related to the size of 
the payload, is the number of HTTP requests a client needs to make to get all 
of the required data. This is the challenge that “transclude” preference 
addresses.</t>

<t>When server sends hypermedia responses (e.g. in the case of Hypermedia APIs) 
some of the response data may be referenced via a URI link instead of being 
embedded in the payload itself. The need to grab data from a link can degrade 
experience of mobile applications, since they are forced to make multiple 
requests to per single end-user request. This is sometimes referred to as 
“chatty interface” and is a significant problem for mobile and Internet of 
Things scenarios.</t>

<t>Transclude preference notifies the server that the client would prefer the
server to proactively transclude certain content represented by links of
indicated link relation types. The notion of “link relation type”, in this
context is as defined by <xref target="RFC8288"/></t>

<t>As a result of using a transclude preference, a client receives all of the
required data already embedded in the response output, without the need to make
additional network calls.</t>

</section>
<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be
interpreted as described in <xref target="RFC2119"/>.</t>

</section>
<section anchor="transclude-usage-example" title="Transclude Usage Example">

<t>Following is an example of a client asking server to transclude data represented 
at the copyright, edit-form and “other-form” links. Since “other-form” is not 
a standard, IANA link relation type, client is using a URI for identifying the 
link relation type.</t>

<figure><artwork><![CDATA[
Get /blog/1223 HTTP/1.1
Host: api.example.org
Content-Type: application/json  
Prefer: transclude="copyright;edit-form;http://rels.io/other-form"
Vary: Prefer,Accept,Accept-Encoding
]]></artwork></figure>

<t>As you can see from the example, the transclude preference expects the value 
to be enclosed in double quotes, if there are multiple link relation types 
provided. Further, standard link relations SHOULD be indicated by name while 
custom link relation types SHOULD be indicated with a unique URI representing 
that link relation. Multiple link relation types MUST be separated by 
semicolons.</t>

<t>Example response may look something like the following:</t>

<figure><artwork><![CDATA[
HTTP/1.1 200 OK
Server: nginx/1.10.3 (Ubuntu)
Date: Sat, 27 Jun 2017 10:07:32 GMT
Content-Type: application/json; charset=utf-8
Transfer-Encoding: chunked
Connection: close
Vary: Prefer,Accept,Accept-Encoding
Preference-Applied: transclude="copyright;edit-form"
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: Content-Type
]]></artwork></figure>

<t>As you can see from this output, the server only transcluded copyright and 
edit-form link relation types, but not the custom type client requested. This 
is because preferences are just suggestions and server has no obligation related 
to them. In this case, we can assume that the server skipped the last link 
relation type because maybe it wasn’t familiar with it, or for some other 
reason.</t>

</section>
<section anchor="implementation-considerations" title="Implementation Considerations">

<t>Transclude preference is media-type agnostic. It should work with any response 
content-type. The mechanics of transclusion, however will either depend on 
capabilities of the response media-type or require a multi-part response with 
multiple media types in the response.</t>

</section>
<section anchor="multipart-response-example" title="Multipart Response Example">

<figure><artwork><![CDATA[
HTTP/1.1 200 OK
Server: nginx/1.4.6 (Ubuntu)
Date: Thu, 15 Sep 2017 11:07:32 GMT
Content-type: multipart/mixed; boundary="some boundary string"

--some boundary string
Content-Type: application/hal+json; charset=utf-8

{
    "_links": {
        "self": { "href": "/orders" },
        "edit-form": { "href": "/create" }
    },
    "currentlyProcessing": 14,
    "shippedToday": 20
}

--some boundary string
Content-Type: application/prs.hal-forms+json

{
    "_links" : {
        "self" : { "href" : "/create" }
    },
    "_templates" : {
        "default" : {
            "title" : "Create",
            "method" : "post",
            "contentType" : "application/json",
            "properties" : [
                {"name": "title", "required": true, 
                 "prompt": "Title"},
                {"name": "completed", "value": "false", 
                 "prompt": "Completed"}
            ]
        }
    }
}
--some boundary string--
]]></artwork></figure>

</section>
<section anchor="security-considerations" title="Security Considerations">

<t>None.</t>

</section>
<section anchor="iana-considerations" title="IANA Considerations">

<t>The HTTP Preference below is being registered with IANA per Section 5.1 of 
<xref target="RFC7240"/>:</t>

<t>Preference: transclude
Value:
Optional Parameters:
Description:
Reference: RFC XXXX</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="RFC8288" target='https://www.rfc-editor.org/info/rfc8288'>
<front>
<title>Web Linking</title>
<author initials='M.' surname='Nottingham' fullname='M. Nottingham'><organization /></author>
<date year='2017' month='October' />
<abstract><t>This specification defines a model for the relationships between resources on the Web (&quot;links&quot;) and the type of those relationships (&quot;link relation types&quot;).</t><t>It also defines the serialisation of such links in HTTP headers with the Link header field.</t></abstract>
</front>
<seriesInfo name='RFC' value='8288'/>
<seriesInfo name='DOI' value='10.17487/RFC8288'/>
</reference>



<reference  anchor="RFC2119" target='https://www.rfc-editor.org/info/rfc2119'>
<front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
<date year='1997' month='March' />
<abstract><t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='2119'/>
<seriesInfo name='DOI' value='10.17487/RFC2119'/>
</reference>



<reference  anchor="RFC7240" target='https://www.rfc-editor.org/info/rfc7240'>
<front>
<title>Prefer Header for HTTP</title>
<author initials='J.' surname='Snell' fullname='J. Snell'><organization /></author>
<date year='2014' month='June' />
<abstract><t>This specification defines an HTTP header field that can be used by a client to request that certain behaviors be employed by a server while processing a request.</t></abstract>
</front>
<seriesInfo name='RFC' value='7240'/>
<seriesInfo name='DOI' value='10.17487/RFC7240'/>
</reference>




    </references>



<section anchor="acknowledgments" title="Acknowledgments">

</section>


  </back>

<!-- ##markdown-source:
H4sIAIM1XVoAA51Z23IbNxJ9x1eg6IdNvCR1sRM79DoVlazEytqSV6I2m0ql
XOAMSCKaGUwAjGSuS/n2Pd3AXCjRTmpVZWtmcOvL6dPd0GQyEcGEQs/k3KnK
Z0WTa/nO6aV2usq0XFonw1rL1/P5u/RdvtYq106oxcLpm62FNHswU+Q2q1SJ
zU2lcuW0mdQ8MAndGpGrgAmH+wfPRYbHlXUbmr+0QpjazWRwjQ+H+/vf7B8K
bKFm8gddaacKcWvd9crZpp6Ja73BWz6Tp1XQrtJh8sqpZRDCB1Xl71VhKxyy
0V7UZiZ/CTYbS/xnqlxXYSy9dQGCeTxtyvQQnMkwlNmyVumhxGQMmaowlf5V
CNWEtXUzISdC4sdUHgJM5VnU1a9vTGF4JBrh1KnrwuwYxllah5k8OHgqvwpr
eXSjq0bzUGYCzHGmb+XP0DZ+sk0VyEhXlQk6l5cBZvM8pEtlCliPD/puRW9T
yM1jjYPm6xDq2d7e7e3tdOm0Xy+Kxi08zdnb0uJkKn8yRa4H0p84cz34mI7S
+Dq9pa/f5U6HKUz/4LR2YA//6HlPiMq6UgVzo2E8efH98fPD58/T4+HBwTfp
8dnh0/0ZYAAwDKY/ikNP9ruXr58/wWoxmUykWsCY8JcQc6B2AM26x7TxUkmn
V8YDKzDgQq/VjQF0d4F9zWCXYml0kU/lafCyblxtPe9DK7LCEC6AJ+lrnZnl
ZnAYPq9VkJl2QZlKAjjXHiaWgiTwta2wj1/bpiAx6JMtbkikDQvitbvRjhAH
UVUu7RKzTLWKA7lUPu0o+BRaEqWRmara3abRMpUN+v0Z/Rfs+wvWygvx+DHs
J09enc7PL2ayLrTyJEZpbzS2g4ZeZ8HYCudCV5ixWRQGcYpPjx9HIxvvG02C
+JAsiGU5hR9LsSBaaCoIG+Q/CBEekFiZsG4WjLuWGvZ4yUOC2Iv7fzuNp5UW
xzidkZLxEHLnYOt2v2k6w9hP7vxtMk1p8rzQQjwi+nA2b1hlIUZbhNex20h+
/JjQeXcHX1tCA4SoInASYqLfowEaD2cJAASEQ9bTcbRWLpisKZRLnu6giN1c
i1nX4yE5d9EESVxIPoUtfm8MzSHxfJMBc37ZFExchWbfATa0mmZqHwjEctk4
fHIy10twGQDk9Q2RqmTCVC4fJAFiwyZbE9pomxFCuHHVaIDyqZwPB8Qg2CCC
H2BZXlf2Vt5H6y0HQFyF2IxhZDIpnMZHjymqVYTjxjaO4riSgyiq1aawKh9L
PV1NoV9RyHurxY2fYkVpKlNCU6QE+H+gJiB8rbdVxBz2ROYMPIVFZOTSLkwB
hYBB5Yz1ZJj0Tai6buMj+hA6b6B75Q3xF5EEWJAylyyAgyrbIBGtkcRW6xpe
VRQn1QYhhCAXHYRMCZRhta7yCbDkpP5Qg3lJauiLbAFBO7tMMpwNlMOveXsY
FBfbhKaKwt765BUmr9CQshDA1sGU5r8wMFx3375yoRjMODA5rx4ChexDbKXw
OqNdbVWw/nlrIlho4IRue3G7hhoGQW21r/4WIDlhOroxKpYYwJNoCdKtUOAA
igX6xAcOAPjAiIIsOOktSDi679KxXNtbioipPC4Q3djSaXJYzpYaSCEGYoxJ
DnqvmnIBG2OYGSEFHqWdZDNSjo1eqmsGxUoHcgns2scqRzXKI0XhhZ3T5tka
E3W1SqqNekIbhiSgmCPZejAT7PYTGTdFIDnDy/UG+pc6N30IefkFxw7swedQ
KiAV+plH7079l+AKW+qeVJIDSVCos4l5LEmRyxssU/Lq4pQz1cNMJjRMleeY
mY7tXBpg9mVkFsYCWcmpRTxo6WyJfXlPcm6uMYY0LwZ+xRk95rqoBJmZiAu9
4QgFZLO4PTujbIpgaorlzm0YqslwkLcYBGHHp613yC4IHe1lR9xYCnYQIzgt
hA10RMmxVBlcRZHGlYg3q4rYTnEs2UWhyyHN0Ly2qmXAzYkcfI9VCouddQ4i
AvvqLfr9LPPiu2jnWZIFhRRIC+DvMdaVMmCZQDt0JBvTVKxH7FK0qS6PTuLw
IRYOgJNPbrUtq48ezhmNIyKMF3zUh5jpfUpZfBjnYaod7+6EOIplnYf/aMuG
3IUvYZdtxn0oUi0BJT2HXwS12Io+DKDtyDfyPlI76NsmgLzH8hYVB54jBege
UxSKhhQD4bXsj2RSkOseSdRkKg0e2wpkzjCNXIe+RlJj4+Xo7dXlHDbh3/Ls
nJ8vTv51dXpx8oqeL18fvXnTPbQzLl+fX73BuEhP/crj87dvT85excVvj37G
L4La6Pzd/PT87OjNqDU/GDlrqPXhaIFKCy0YxzBniEVorj0y5CKahp1CVfzd
Hes3AOeVV6Ctkw+KShMhvreUhMhNhssnHQdimk/uUf66K3gZlgN/sneG+BMt
uG29cWa1hk/AW2FC/UPUzlLVw++jCNWpvGQ62BpJ6QRFelsOjeXp0dnRDiiP
W0GxpoUcsR0nQuou0Q/QVxJLPFwOC/3xxx/iB8T23qKwq72Dw8MnnDX2DqYH
4jWq3Rnoy0yTbabWrcRxDL3JHBvMhuS295vHvm2qnw1s9XLU2eRFZ5IXqUGD
RJ7q5IEJxL8VtZhxo/ERqso6pF+TkyqzOXRiySnsNrZhEvZaR2ImZZPAY37Z
GYRcxWSpPLxRRaO5Rl4QxWaUdRlOuUXLoeXvDVoXar45Ql0syzqu3kExVIXa
G7gAXdv3sdod99Xt1gIvU3AstOxpC/xCna+8XXNllzU+QLVdJ+1aTVwAKDSV
QZJgRHRA7Wu7rc2m8u3n1OG4XxCRo21oBQRdlyazBXQAklJg9cRE6biw9jpm
Ji4quxp32QbfLEKwxZw83N+X5/8UlxxxM1mtTPWBBvanT+QXV4umCs2X4hXf
2lwqRNjhM/ljU9ENzjN5sD/bfzZ7cih/eDv/E5i+oELGeR1eNmE5eR5zGDVo
LbxmmNBU1zqnjarYhuIbAeMvobOv7CdHdLbO/zQgRuKI+6cJie5sMTkiG03O
Mc3g7Me7h2N76GdyqPDnggNU0aaMQWrmwrUXMO9ZjKlL9Ey2Ax5jbgrbGjhh
lUb6NMfFCkUDlysC/xY6U43XW9cVFFa/YTlavtUKC2Ijg/OTlGtF3ChRpphV
PL8tjEWsjEv0lylxUAWJrKhZf4U2vtR9AdJWo9emrilV4lOhfIoJsaVdJyjw
TEGGskVxj7BUpSkM2meONgN7plucWKFyh4utFODGqeiUwqPsGkL4y4MgnGoz
7qeui7j6nbAoalWBk03GXXS6ueGEHgO+2gxamlQi8cJY8ZQaoK9M5rnSSMd5
nN41HNgHdYg2qTuvqXOi3jVTtUI9iDJC+we190A+69regbosIpQJXTP0c1lO
0TFnLOwjxdyra9hkkZNoh4t2hy5//xXaeDr9+j5rzNfNWB58JS91nVjjYAdr
BGaNsj1+rzQfdP5CLuguCdH/csQ+bl/5vrZajehCZ9fAZ8gI7dTfdxGS+Mg3
maP3XCeMZjK+8zdqTeiLHK0BFDyN9lClgQRG8m7cT+uJZXtuBkwG9AB3PDWt
GGUNWoYqFJt3zhLNkD4zefA0Dfs1R8rc5mozohtzcfd/aFs7P4XGLJVnve8r
Kh9qKnvx5aflfx80cEGX0ff2QMWu4MftrzzCf3vgPY/jluPtccpaNucJNcLu
/nAKMNKS59zPMffn010d2hcTJfxla5B+Po4o45OLomBjugmKrcCI/xIBOnuw
iLct60DL5rzsbvyZndO9HHbE7lz10NelKjyd99ndj7uld1vzfu3ekkOAjN3A
mExiXnqE4APcDFrS+yR4Fu/FHsWC9wFFbl+PM0EuNLKg5HxCFcbgZp25hveh
/vkyXSV/BbagRnZwizobXsQN0zQyPSw0E+d1apHeofgBKijfilfcdvDITFz0
y+lK+z/4ibe7C5Vdkz5HGd09Fjpf8d9xxP8AdDj1E/waAAA=

-->

</rfc>

